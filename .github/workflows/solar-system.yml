name: Solar System

on:  
  workflow_dispatch: 
  push:
    branches: 
      - main
      - '!feature/*'    # ignoring pushing to any feature branch using !

env:
  DOCKERHUB_USERNAME: siddharth67

jobs:
  # unit-testing:
  #   strategy:
  #     matrix:
  #       node_version: [19]
  #       operating_system: [ubuntu-latest]
  #       experimental: [false]
  #       # include:
  #       #   - node_version: 20
  #       #     operating_system: windows-latest
  #       #     experimental: true
  #     max-parallel: 3  
  #   runs-on: ${{ matrix.operating_system }}
  #   continue-on-error: ${{ matrix.experimental }}
  #   steps:
  #     - name: Checkout Repository
  #       uses: actions/checkout@v3

  #     - name: Setup NodeJS Version - ${{ matrix.node_version }} on ${{ matrix.operating_system }}
  #       uses: actions/setup-node@v3
  #       with:
  #         node-version: ${{ matrix.node_version }}
          
  #     - name: Cache NPM dependencies
  #       uses: actions/cache@v3
  #       with:
  #         path: ~/.npm
  #         key: ${{ runner.os }}-node-modules-${{ hashFiles('package-lock.json') }}     
      
  #     - name: NPM Install
  #       run: npm install
        
  #     - name: NPM Testing
  #       run: NODE_ENV=deploy npm test

  #     - name: Archive Test Result
  #       uses: actions/upload-artifact@v3
  #       with:
  #         name: Mocha-Test-Result
  #         path: test-results.xml

  # code-coverage:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout Repository
  #       uses: actions/checkout@v3

  #     - name: Setup NodeJS Version - 19
  #       uses: actions/setup-node@v3
  #       with:
  #         node-version: 19

  #     - name: Cache NPM dependencies
  #       uses: actions/cache@v3
  #       with:
  #         path: ~/.npm
  #         key: ${{ runner.os }}-node-modules-${{ hashFiles('package-lock.json') }}    
             
  #     - name: NPM Install
  #       run: npm install
      
  #     - name: NPM Code Coverage
  #       run: NODE_ENV=deploy npm run coverage
  #       continue-on-error: true

  #     - name: Archive Code Coverage Result
  #       uses: actions/upload-artifact@v3
  #       with:
  #         name: Code-Coverage-Result
  #         path: coverage

  docker:
    runs-on: ubuntu-latest
  #  needs: [code-coverage, unit-testing]
    steps:
      - name: Dockerhub Login
        uses: docker/login-action@v2.2.0
        with:
          username: $DOCKERHUB_USERNAME
          password: ${{ secrets.DOCKERHUB_PASSWORD }}